<h1 id="ellipj">ellipj</h1><blockquote><p>Compute the <a href="https://en.wikipedia.org/wiki/Jacobi_elliptic_functions">Jacobi elliptic functions</a> sn, cn, and dn.</p></blockquote><section class="intro"><p>The <a href="https://en.wikipedia.org/wiki/Jacobi_elliptic_functions">Jacobi elliptic functions</a> may be defined as the inverse of the <a href="https://en.wikipedia.org/wiki/Elliptic_integral">incomplete elliptic integral of the first kind</a>. Accordingly, they compute the value <code>φ</code> which satisfies the equation</p><div class="equation" align="center" data-raw-text="u=\int_{0}^{\varphi}{\frac {\mathrm{d} \theta }{\sqrt {1-m\sin^{2}\theta }}}" data-equation="eq:incomplete_elliptic_integral_first_kind"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.564ex" height="6.676ex" style="vertical-align:-3.171ex" viewBox="0 -1508.9 10145.7 2874.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title"><title id="MathJax-SVG-1-Title">u equals integral Subscript 0 Superscript phi Baseline StartFraction normal d theta Over StartRoot 1 minus m sine squared theta EndRoot EndFraction</title><defs aria-hidden="true"><path stroke-width="1" id="E1-MJMATHI-75" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="1" id="E1-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="1" id="E1-MJSZ2-222B" d="M114 -798Q132 -824 165 -824H167Q195 -824 223 -764T275 -600T320 -391T362 -164Q365 -143 367 -133Q439 292 523 655T645 1127Q651 1145 655 1157T672 1201T699 1257T733 1306T777 1346T828 1360Q884 1360 912 1325T944 1245Q944 1220 932 1205T909 1186T887 1183Q866 1183 849 1198T832 1239Q832 1287 885 1296L882 1300Q879 1303 874 1307T866 1313Q851 1323 833 1323Q819 1323 807 1311T775 1255T736 1139T689 936T633 628Q574 293 510 -5T410 -437T355 -629Q278 -862 165 -862Q125 -862 92 -831T55 -746Q55 -711 74 -698T112 -685Q133 -685 150 -700T167 -741Q167 -789 114 -798Z"></path><path stroke-width="1" id="E1-MJMATHI-3C6" d="M92 210Q92 176 106 149T142 108T185 85T220 72L235 70L237 71L250 112Q268 170 283 211T322 299T370 375T429 423T502 442Q547 442 582 410T618 302Q618 224 575 152T457 35T299 -10Q273 -10 273 -12L266 -48Q260 -83 252 -125T241 -179Q236 -203 215 -212Q204 -218 190 -218Q159 -215 159 -185Q159 -175 214 -2L209 0Q204 2 195 5T173 14T147 28T120 46T94 71T71 103T56 142T50 190Q50 238 76 311T149 431H162Q183 431 183 423Q183 417 175 409Q134 361 114 300T92 210ZM574 278Q574 320 550 344T486 369Q437 369 394 329T323 218Q309 184 295 109L286 64Q304 62 306 62Q423 62 498 131T574 278Z"></path><path stroke-width="1" id="E1-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path stroke-width="1" id="E1-MJMAIN-64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z"></path><path stroke-width="1" id="E1-MJMATHI-3B8" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z"></path><path stroke-width="1" id="E1-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path stroke-width="1" id="E1-MJMAIN-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path stroke-width="1" id="E1-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="1" id="E1-MJMAIN-73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z"></path><path stroke-width="1" id="E1-MJMAIN-69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z"></path><path stroke-width="1" id="E1-MJMAIN-6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path stroke-width="1" id="E1-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path stroke-width="1" id="E1-MJSZ1-221A" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"><use xlink:href="#E1-MJMATHI-75" x="0" y="0"></use><use xlink:href="#E1-MJMAIN-3D" x="850" y="0"></use><g transform="translate(1906,0)"><use xlink:href="#E1-MJSZ2-222B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#E1-MJMATHI-3C6" x="1500" y="1540"></use><use transform="scale(0.707)" xlink:href="#E1-MJMAIN-30" x="787" y="-1270"></use></g><g transform="translate(3696,0)"><g transform="translate(120,0)"><rect stroke="none" width="6208" height="60" x="0" y="220"></rect><g transform="translate(2591,676)"><use xlink:href="#E1-MJMAIN-64" x="0" y="0"></use><use xlink:href="#E1-MJMATHI-3B8" x="556" y="0"></use></g><g transform="translate(60,-1080)"><use xlink:href="#E1-MJSZ1-221A" x="0" y="148"></use><rect stroke="none" width="5088" height="60" x="1000" y="939"></rect><g transform="translate(1000,0)"><use xlink:href="#E1-MJMAIN-31" x="0" y="0"></use><use xlink:href="#E1-MJMAIN-2212" x="722" y="0"></use><use xlink:href="#E1-MJMATHI-6D" x="1723" y="0"></use><g transform="translate(2768,0)"><use xlink:href="#E1-MJMAIN-73"></use><use xlink:href="#E1-MJMAIN-69" x="394" y="0"></use><use xlink:href="#E1-MJMAIN-6E" x="673" y="0"></use><use transform="scale(0.707)" xlink:href="#E1-MJMAIN-32" x="1738" y="561"></use></g><use xlink:href="#E1-MJMATHI-3B8" x="4618" y="0"></use></g></g></g></g></g></svg></div><p>where the parameter <code>m</code> is related to the modulus <code>k</code> by <code>m = k^2</code>.</p></section><section class="usage"><h2 id="usage">Usage</h2><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> ellipj = <span class="hljs-built_in">require</span>( <span class="hljs-string">'@stdlib/math/base/special/ellipj'</span> );
</code></pre><h4 id="ellipj-u-m-">ellipj( u, m )</h4><p>Computes the <a href="https://en.wikipedia.org/wiki/Jacobi_elliptic_functions">Jacobi elliptic functions</a> functions <code>sn</code>, <code>cn</code>, and <code>dn</code>, and the Jacobi amplitude <code>am</code>.</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> v = ellipj( <span class="hljs-number">0.3</span>, <span class="hljs-number">0.5</span> );
<span class="hljs-comment">// returns [ ~0.293, ~0.956, ~0.978, ~0.298 ]</span>

v = ellipj( <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span> );
<span class="hljs-comment">// returns [ ~0.0, ~1.0, ~1.0, ~0.0 ]</span>

v = ellipj( <span class="hljs-literal">Infinity</span>, <span class="hljs-number">1.0</span> );
<span class="hljs-comment">// returns [ ~1.0, ~0.0, ~0.0, ~1.571 ]</span>

v = ellipj( <span class="hljs-number">0.0</span>, -<span class="hljs-number">2.0</span> );
<span class="hljs-comment">// returns [ ~0.0, ~1.0, ~1.0, NaN ]</span>

v = ellipj( <span class="hljs-literal">NaN</span>, <span class="hljs-literal">NaN</span> );
<span class="hljs-comment">// returns [ NaN, NaN, NaN, NaN ]</span>
</code></pre><h4 id="ellipjassign-u-m-out-stride-offset-">ellipj.assign( u, m, out, stride, offset )</h4><p>Computes the Jacobi elliptic functions <code>sn</code>, <code>cn</code>, <code>dn</code>, and Jacobi amplitude <code>am</code> and assigns results to a provided output array.</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> <span class="hljs-built_in">Float64Array</span> = <span class="hljs-built_in">require</span>( <span class="hljs-string">'@stdlib/array/float64'</span> );

<span class="hljs-keyword">var</span> out = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Float64Array</span>( <span class="hljs-number">4</span> );

<span class="hljs-keyword">var</span> v = ellipj.assign( <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, out, <span class="hljs-number">1</span>, <span class="hljs-number">0</span> );
<span class="hljs-comment">// returns &#x3C;Float64Array>[ ~0.0, ~1.0, ~1.0, ~0.0 ]</span>

<span class="hljs-keyword">var</span> bool = ( v === out );
<span class="hljs-comment">// returns true</span>
</code></pre><h4 id="ellipjsn-u-m-">ellipj.sn( u, m )</h4><p>Computes the Jacobi elliptic function <code>sn</code> of value <code>u</code> with modulus <code>m</code>.</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> v = ellipj.sn( <span class="hljs-number">0.3</span>, <span class="hljs-number">0.5</span> );
<span class="hljs-comment">// returns ~0.293</span>
</code></pre><h4 id="ellipjcn-u-m-">ellipj.cn( u, m )</h4><p>Computes the Jacobi elliptic function <code>cn</code> of value <code>u</code> with modulus <code>m</code>.</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> v = ellipj.cn( <span class="hljs-number">0.3</span>, <span class="hljs-number">0.5</span> );
<span class="hljs-comment">// returns ~0.956</span>
</code></pre><h4 id="ellipjdn-u-m-">ellipj.dn( u, m )</h4><p>Computes the Jacobi elliptic function <code>dn</code> of value <code>u</code> with modulus <code>m</code>.</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> v = ellipj.dn( <span class="hljs-number">0.3</span>, <span class="hljs-number">0.5</span> );
<span class="hljs-comment">// returns ~0.978</span>
</code></pre><h4 id="ellipjam-u-m-">ellipj.am( u, m )</h4><p>Computes the Jacobi amplitude <code>am</code> of value <code>u</code> with modulus <code>m</code>.</p><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> v = ellipj.am( <span class="hljs-number">0.3</span>, <span class="hljs-number">0.5</span> );
<span class="hljs-comment">// returns ~0.298</span>

v = ellipj.am( <span class="hljs-number">0.3</span>, <span class="hljs-number">2.0</span> );
<span class="hljs-comment">// returns NaN</span>
</code></pre><p>Although <code>sn</code>, <code>cn</code>, and <code>dn</code> may be computed for <code>-∞ &#x3C; m &#x3C; ∞</code>, the domain of <code>am</code> is <code>0 ≤ m ≤ 1</code>. For <code>m &#x3C; 0</code> or <code>m > 1</code>, the function returns <code>NaN</code>.</p></section><section class="notes"><h2 id="notes">Notes</h2><ul><li>Functions <code>sn</code>, <code>cn</code>, and <code>dn</code> are valid for <code>-∞ &#x3C; m &#x3C; ∞</code>. Values for <code>m &#x3C; 0</code> or <code>m > 1</code> are computed in terms of Jacobi elliptic functions with <code>0 &#x3C; m &#x3C; 1</code> via the transformations outlined in Equations 16.13 and 16.15 from <em>The Handbook of Mathematical Functions</em> (Abramowitz and Stegun).</li><li>If more than one of <code>sn</code>, <code>cn</code>, <code>dn</code>, or <code>am</code> is to be computed, preferring using <code>ellipj</code> to compute all four values simultaneously.</li></ul></section><section class="examples"><h2 id="examples">Examples</h2><pre><code class="hljs language-javascript"><span class="hljs-keyword">var</span> linspace = <span class="hljs-built_in">require</span>( <span class="hljs-string">'@stdlib/array/base/linspace'</span> );
<span class="hljs-keyword">var</span> ellipk = <span class="hljs-built_in">require</span>( <span class="hljs-string">'@stdlib/math/base/special/ellipk'</span> );
<span class="hljs-keyword">var</span> ellipj = <span class="hljs-built_in">require</span>( <span class="hljs-string">'@stdlib/math/base/special/ellipj'</span> );

<span class="hljs-keyword">var</span> m = <span class="hljs-number">0.7</span>;
<span class="hljs-keyword">var</span> u = linspace( <span class="hljs-number">0.0</span>, ellipk( m ), <span class="hljs-number">100</span> );

<span class="hljs-keyword">var</span> out;
<span class="hljs-keyword">var</span> i;
<span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &#x3C; <span class="hljs-number">100</span>; i++ ) {
    out = ellipj( u[ i ], m );
    <span class="hljs-built_in">console</span>.log( <span class="hljs-string">'sn(%d, %d) = %d'</span>, u[ i ], m, out[ <span class="hljs-number">0</span> ] );
    <span class="hljs-built_in">console</span>.log( <span class="hljs-string">'cn(%d, %d) = %d'</span>, u[ i ], m, out[ <span class="hljs-number">1</span> ] );
    <span class="hljs-built_in">console</span>.log( <span class="hljs-string">'dn(%d, %d) = %d'</span>, u[ i ], m, out[ <span class="hljs-number">2</span> ] );
    <span class="hljs-built_in">console</span>.log( <span class="hljs-string">'am(%d, %d) = %d'</span>, u[ i ], m, out[ <span class="hljs-number">3</span> ] );
}
</code></pre></section><hr><section class="references"><h2 id="references">References</h2><ul><li>Fukushima, Toshio. 2009. "Fast computation of complete elliptic integrals and Jacobian elliptic functions." <em>Celestial Mechanics and Dynamical Astronomy</em> 105 (4): 305. doi:<a href="https://doi.org/10.1007/s10569-009-9228-z">10.1007/s10569-009-9228-z</a>.</li><li>Fukushima, Toshio. 2015. "Precise and fast computation of complete elliptic integrals by piecewise minimax rational function approximation." <em>Journal of Computational and Applied Mathematics</em> 282 (July): 71–76. doi:<a href="https://doi.org/10.1016/j.cam.2014.12.038">10.1016/j.cam.2014.12.038</a>.</li></ul></section><section class="related"><hr><h2 id="see-also">See Also</h2><ul><li><span class="package-name"><a href="/docs/api/latest/@stdlib/math/base/special/ellipe"><code>@stdlib/math/base/special/ellipe</code></a></span><span class="delimiter">: </span><span class="description">compute the complete elliptic integral of the second kind.</span></li><li><span class="package-name"><a href="/docs/api/latest/@stdlib/math/base/special/ellipk"><code>@stdlib/math/base/special/ellipk</code></a></span><span class="delimiter">: </span><span class="description">compute the complete elliptic integral of the first kind.</span></li></ul></section><section class="links"></section>